language: java
jdk:
- oraclejdk11

services:
- rabbitmq
- mongodb
- redis-server
- mysql

notifications:
  slack: gridgo:EkUUzu8RhdhIVeNKg9JlcuIv
  
addons:
  apt:
    packages:
    - rabbitmq-server 
  sonarcloud:
    organization: "gridgo"
    token: $SONAR_TOKEN

before_script:
  - go get -v go.etcd.io/etcd
  - $GOPATH/bin/etcd &

before_install:
  - sudo apt-get install -y libpgm-dev 
  - sudo apt-get install -y libstdc++6
  - mysql -e 'CREATE DATABASE IF NOT EXISTS test;'

after_success:
- mvn clean test jacoco:report sonar:sonar -Dsonar.projectKey=gridgo_gridgo-connector
- bash <(curl -s https://codecov.io/bash)
